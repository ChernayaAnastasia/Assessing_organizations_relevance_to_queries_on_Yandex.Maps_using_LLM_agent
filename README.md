# Assessing Organizations Relevance to Queries on Yandex.Maps using LLM Agent
(ะัะตะฝะบะฐ ัะตะปะตะฒะฐะฝัะฝะพััะธ ะพัะณะฐะฝะธะทะฐัะธะน ะทะฐะฟัะพัะฐะผ ะฝะฐ ะฏะฝะดะตะบั.ะะฐััะฐั ั ะฟะพะผะพััั LLM-ะฐะณะตะฝัะฐ)

**๐ ะัะพะณะพะฒัะน ะฟัะพะตะบั ะบัััะฐ NLP ัะบะพะปั Deep Learning School**  
**๐ฏ ะฆะตะปั:** ะะพัััะพะตะฝะธะต LLM-ะฐะณะตะฝัะฐ, ะบะพัะพััะน ะพัะตะฝะธะฒะฐะตั ัะตะปะตะฒะฐะฝัะฝะพััั ะพัะณะฐะฝะธะทะฐัะธะน ะฝะฐ ะฏะฝะดะตะบั.ะะฐััะฐั ัะธัะพะบะธะผ ะฟะพะปัะทะพะฒะฐัะตะปััะบะธะผ ะทะฐะฟัะพัะฐะผ. ะะณะพ ััะฐะฒะฝะตะฝะธะต ั ัะธะปัะฝัะผ ะฑะตะนะทะปะฐะนะฝะพะผ.

---

## ๐ ะะฟะธัะฐะฝะธะต ะฟัะพะตะบัะฐ

ะัะพะตะบั ะฝะฐะฟัะฐะฒะปะตะฝ ะฝะฐ ะธััะปะตะดะพะฒะฐะฝะธะต ะธ ัะตะฐะปะธะทะฐัะธั ะฟะพะดัะพะดะพะฒ ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ ะฑะพะปััะธั ัะทัะบะพะฒัั ะผะพะดะตะปะตะน (LLM) ะดะปั ะทะฐะดะฐัะธ **ะพัะตะฝะบะธ ัะตะปะตะฒะฐะฝัะฝะพััะธ** ะพัะณะฐะฝะธะทะฐัะธะน ะทะฐะฟัะพัะฐะผ ะฟะพะปัะทะพะฒะฐัะตะปะตะน ะฒ ะณะตะพัะตัะฒะธัะต.  
LLM-ะฐะณะตะฝั ะฐะฝะฐะปะธะทะธััะตั ะฒัะพะดะฝัะต ะดะฐะฝะฝัะต (ะทะฐะฟัะพั ะธ ะธะฝัะพัะผะฐัะธั ะพะฑ ะพัะณะฐะฝะธะทะฐัะธะธ), ะฟัะธ ะฝะตะพะฑัะพะดะธะผะพััะธ ะทะฐะฟัะฐัะธะฒะฐะตั ะดะพะฟะพะปะฝะธัะตะปัะฝัะน ะบะพะฝัะตะบัั ัะตัะตะท ะฟะพะธัะบ, ะธ ะฒัะดะฐะตั ะฑะธะฝะฐัะฝะพะต ัะตัะตะฝะธะต: **ัะตะปะตะฒะฐะฝัะฝะฐ ะปะธ ะพัะณะฐะฝะธะทะฐัะธั ะทะฐะฟัะพัั**.

ะะพะดะตะปั ะฟัะพัะตััะธัะพะฒะฐะฝะฐ ะฝะฐ ัะฐะทะปะธัะฝัั ะฟัะพะผะฟัะฐั ะธ ะฒะตััะธัั ะฐะณะตะฝัะพะฒ ะธ ััะฐะฒะฝะธะฒะฐะตััั ั ะฑะตะนะทะปะฐะนะฝะพะผ.

---

## ๐ ะกัััะบัััะฐ ัะตะฟะพะทะธัะพัะธั

```bash
llm_relevance_agent/
โโโ baseline/                  # ะะตะนะทะปะฐะนะฝ-ะผะพะดะตะปั ะฝะฐ GPT ะฑะตะท ะฒะฝะตัะฝะตะณะพ ะฟะพะธัะบะฐ
โ   โโโ llm_interface.py       # ะะฑัััะบะฐ ะฝะฐะด OpenAI API
โ   โโโ prompt_templates.py    # ะัะพะผัั ะดะปั ะฑะตะนะทะปะฐะนะฝะฐ
โ   โโโ core.py                # ะะปะฐัั RelevanceBaseline
โ   โโโ run_baseline.py        # ะะฐะฟััะบ ะฑะตะนะทะปะฐะนะฝะฐ 
โ
โโโ agent/                     # ะะตะฐะปะธะทะฐัะธั LLM-ะฐะณะตะฝัะฐ
โ   โโโ prompts/               # ะะฐะทะฝัะต ะฒะตััะธะธ ะฟัะพะผัะพะฒ
โ   โโโ agent_graph.py         # ะัะฐั ะฐะณะตะฝัะฐ ะฝะฐ langgraph
โ   โโโ agent_nodes*.py        # ะฃะทะปั ะณัะฐัะฐ (ะฒะตััะธะธ)
โ   โโโ eval_agent.py          # ะะพะดัะปั RelevanceAgentEvaluator ะดะปั ะพัะตะฝะบะธ ะฐะณะตะฝัะฐ
โ   โโโ promt_loader.py        # ะะฐะณััะทะบะฐ ะฟัะพะผัะพะฒ ะฟะพ ะฒะตััะธะธ
โ   โโโ search_tools.py        # ะะฝัะตะณัะฐัะธั ะฟะพะธัะบะฐ (Tavily)
โ
โโโ data/                      # ะะฐัะฐัะตัั 
โ   โโโ data_final_for_dls.jsonl   
โ   โโโ data_final_for_dls_new.jsonl 
โ
โโโ experiments/               # ะัะตะดัะบะฐะทะฐะฝะธั, ะปะพะณะธ ะธ ะฐะฝะฐะปะธะท
โ   โโโ agent/                 # ะัะตะดัะบะฐะทะฐะฝะธั ัะฐะทะฝัั ะฒะตััะธะน ะฐะณะตะฝัะฐ
โ   โ   โโโ *.csv              # ะัะตะดัะบะฐะทะฐะฝะธั
โ   โ   โโโ agent_error_analysis.ipynb  # ะะฝะฐะปะธะท ะพัะธะฑะพะบ ะฐะณะตะฝัะฐ ะธ ะฒัะฒะพะดั ะฟัะพะตะบัะฐ 
โ   โ   โโโ run_agent_ipynb.ipynb   # ะะปั ะทะฐะฟััะบะฐ ะฑะตะนะทะปะฐะนะฝะฐ ะฒ Jupiter Notebook 
โ   โ   โโโ agent_logs/
โ   โ   โโโ analysis_errors/
โ   โ   โโโ search_cache_v1/
โ   โ   โโโ search_cache_v3/
โ   โโโ baseline_test_predictions.csv
โ   โโโ baseline_val_predictions.csv
โ   โโโ run_baseline_pipeline.ipynb  # ะะปั ะทะฐะฟััะบะฐ ะฐะณะตะฝัะฐ ะฒ Jupiter Notebook 
โ   โโโ baseline_val_errors_analysis.ipynb
โ   โโโ baseline_val_predictions_old.csv
โ
โโโ utils/                     # ะฃัะธะปะธัั
โ   โโโ data_loader.py
โ   โโโ config.py
โ   โโโ inspector.py
โ   โโโ unify_columns.py
โ   โโโ __init__.py
โ
โโโ requirements.txt           # ะะฐะฒะธัะธะผะพััะธ pip
โโโ environment.yml            # ะะฐะฒะธัะธะผะพััะธ conda
โโโ .env                       # ะะปััะธ API ะธ ะบะพะฝัะธะณััะฐัะธะธ
โโโ main_runner.py             # ะัะฝะพะฒะฝะพะน ะฒัะพะด ะดะปั ะทะฐะฟััะบะฐ ะฐะณะตะฝัะฐ
```

### ๐ ะัััััะน ััะฐัั

ะะฐะณััะทะธัั [ะดะฐะฝะฝัะต](https://drive.google.com/file/d/1WADIWzvNcQTA6X4FGYKV6f0m1z0URYhj/view?usp=sharing)

#### ะฃััะฐะฝะพะฒะธัั ะทะฐะฒะธัะธะผะพััะธ

conda env create -f environment.yml

conda activate llm_relevance

#### ะะฐะฟัััะธัั ะฑะตะนะทะปะฐะนะฝ
python baseline/run_baseline.py --batch_size 5 --output_prefix baseline

ะธะปะธ ัะตัะตะท ะฝะพััะฑัะบ:
experiments/run_baseline_pipeline.ipynb

#### ะะฐะฟัััะธัั ะฐะณะตะฝัะฐ
python llm_relevance_agent/main_runner.py --batch_size 5

ะธะปะธ ัะตัะตะท ะฝะพััะฑัะบ:
experiments/agent/run_agent_ipynb.ipynb

